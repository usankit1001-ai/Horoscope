import{r as m,j as e,R as Fe}from"./index-BDJg9IIQ.js";const Ae=c=>{var I,ee;const x={url:"",method:"GET",headers:{},body:null},i=c.replace(/\\\n/g," ").replace(/\\\r\n/g," ").trim(),y=i.match(/(?:["'])(https?:\/\/[^"']+)(?:["'])|(https?:\/\/[^\s]+)/i);y&&(x.url=(y[1]||y[2]).split(" ")[0].replace(/["']/g,""));const b=i.match(/(?:-X|--request)\s+["']?(\w+)["']?/i);b?x.method=b[1].toUpperCase():(i.includes("-d ")||i.includes("--data")||i.includes("--data-raw"))&&(x.method="POST");const k=/(?:-H|--header)\s+["']?([^"']+)["']?/g;let p;for(;(p=k.exec(i))!==null;){const U=p[1],R=U.indexOf(":");if(R>-1){const G=U.substring(0,R).trim(),v=U.substring(R+1).trim();x.headers[G]=v}}const h=/(?:-d|--data|--data-raw|--data-binary|--data-urlencode)\s+(?:["'](\{[\s\S]+?\}|[^"']+)["']|(\{[\s\S]+?\}|[^"'\s]+))/,C=i.match(h);return C&&(x.body=C[1]||C[2],Object.keys(x.headers).some(U=>U.toLowerCase()==="content-type")||((I=x.body)!=null&&I.trim().startsWith("{")||(ee=x.body)!=null&&ee.trim().startsWith("["))&&(x.headers["Content-Type"]="application/json")),x},M=(c,x)=>{if(!c)return"";let i=c;return Object.keys(x).sort((b,k)=>k.length-b.length).forEach(b=>{const k=String(x[b]);[new RegExp(`{{\\s*${b}\\s*}}`,"gi"),new RegExp(`{\\s*${b}\\s*}`,"gi"),new RegExp(`:${b}(?![a-zA-Z0-9_])`,"g")].forEach(h=>{i=i.replace(h,k)})}),i},Re=c=>{const x=[];let i=[],y="",b=!1;for(let p=0;p<c.length;p++){const h=c[p],C=c[p+1];b?h==='"'&&C==='"'?(y+='"',p++):h==='"'?b=!1:y+=h:h==='"'?b=!0:h===","?(i.push(y.trim()),y=""):h===`
`||h==="\r"?(i.push(y.trim()),i.some(I=>I!=="")&&x.push(i),i=[],y="",h==="\r"&&C===`
`&&p++):y+=h}if((y||i.length>0)&&(i.push(y.trim()),x.push(i)),x.length<2)return[];const k=x[0].map(p=>p.replace(/^"|"$/g,"").trim());return x.slice(1).map(p=>{const h={};return k.forEach((C,I)=>{h[C]=p[I]||""}),h})},Te=(c,x)=>{if(c.length===0)return;const i=Object.keys(c[0]),y=[i.join(","),...c.map(h=>i.map(C=>`"${String(h[C]||"").replace(/"/g,'""')}"`).join(","))].join(`
`),b=new Blob([y],{type:"text/csv;charset=utf-8;"}),k=document.createElement("a"),p=URL.createObjectURL(b);k.setAttribute("href",p),k.setAttribute("download",x),k.style.visibility="hidden",document.body.appendChild(k),k.click(),document.body.removeChild(k)};var w=(c=>(c.PENDING="PENDING",c.RUNNING="RUNNING",c.PASSED="PASSED",c.FAILED="FAILED",c.ERROR="ERROR",c))(w||{}),Pe=(c=>(c.CONTAINS="CONTAINS",c.EXACT="EXACT",c.STARTS_WITH="STARTS_WITH",c))(Pe||{});const L=["user-agent","referer","origin","host","cookie","sec-fetch-dest","sec-fetch-mode","sec-fetch-site","content-length","connection"],de="horoscope_qa_v3";class Ue extends Fe.Component{constructor(x){super(x),this.state={hasError:!1,error:null}}static getDerivedStateFromError(x){return{hasError:!0,error:x}}componentDidCatch(x,i){console.error("ErrorBoundary caught an error",x,i)}render(){return this.state.hasError?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-8",children:e.jsxs("div",{className:"max-w-3xl w-full bg-rose-900/90 text-white p-8 rounded-2xl shadow-xl",children:[e.jsx("h2",{className:"text-lg font-bold mb-2",children:"An error occurred"}),e.jsx("p",{className:"mb-4",children:"The app encountered an unexpected error while rendering. Please check the console for details."}),e.jsx("pre",{className:"text-xs whitespace-pre-wrap bg-black/20 p-3 rounded",children:String(this.state.error)})]})}):this.props.children}}const ze=()=>{const[c,x]=m.useState(""),[i,y]=m.useState([]),[b,k]=m.useState([]),[p,h]=m.useState([]),[C,I]=m.useState(!1),[ee,U]=m.useState(0),[R,G]=m.useState("description"),[v,q]=m.useState(null),[T,X]=m.useState("bypass"),[K,xe]=m.useState(""),[He,pe]=m.useState(!1),[B,ue]=m.useState({jsonPath:"prediction",strategy:Pe.CONTAINS}),[S,Y]=m.useState([]),[te,he]=m.useState(""),[me,fe]=m.useState(""),[se,ae]=m.useState(null),[W,V]=m.useState(null),[ge,O]=m.useState(null),[re,Q]=m.useState(!1),[le,J]=m.useState(!1),[Z,z]=m.useState(null),Le=/^[A-Za-z0-9-]+$/,be=t=>!t||!t.trim()?"Header key is required":Le.test(t)?L.includes(t.toLowerCase())?"This header is forbidden in browsers":null:"Invalid header key (letters, numbers and hyphen only)",Ie=()=>{const t=te.trim(),s=me,n=be(t);if(n){ae(n);return}Y(a=>{const l=a.findIndex(r=>r.key.toLowerCase()===t.toLowerCase());if(l!==-1){const r=[...a];return r[l]={key:t,value:s},r}return[...a,{key:t,value:s}]}),he(""),fe(""),ae(null)},Oe=t=>{const s=[...S];s.splice(t,1),Y(s)},Ne=(t,s)=>{const n=t.toLowerCase();if(L.includes(n)){V("Cannot add a forbidden header"),setTimeout(()=>V(null),2e3);return}Y(a=>{const l=a.findIndex(r=>r.key.toLowerCase()===n);if(l!==-1){const r=[...a];return r[l]={key:t,value:s},r}return[...a,{key:t,value:s}]}),V(`${t} preset added`),setTimeout(()=>V(null),2e3)},je=async(t=!1)=>{if(Q(!0),O(null),J(!1),z(null),T==="bypass"){O("Warning: Proxy mode may not forward custom headers. Switch to Direct to test headers."),Q(!1);return}try{const s="https://stagingapi.astroapi.com/api/v1/prediction/monthly?language=eng&month=1&year=2026&report=LOVE&zodiac=ARIES";try{const o=(await fetch(s,{method:"OPTIONS"})).headers.get("access-control-allow-headers")||"";if(!/x-api-key/i.test(o)){O('Preflight check: server CORS does not allow "x-api-key" in Access-Control-Allow-Headers. Backend needs to add this header.'),J(!0),z(`Access-Control-Allow-Headers: ${o}`),Q(!1);return}}catch(r){console.debug("Preflight OPTIONS failed",r)}const n={"Content-Type":"application/json"};if(t){const r="iVf8NMjXY7Jmb8pjfKG75gumhnjVKvmasH8cEEt2";n["x-api-key"]=r}else S.forEach(r=>{r.key&&!L.includes(r.key.toLowerCase())&&(n[r.key]=r.value)});const a=await fetch(s,{method:"GET",headers:n}),l=await a.text();a.status===200&&l&&!String(l).toLowerCase().includes("please set custom header")?(O("Header diagnostic: Server accepted headers (OK)."),J(!1)):String(l).toLowerCase().includes("please set custom header")||a.status===401?(O("Header diagnostic: Server indicated missing/invalid header (401 or message)."),J(!0),z(l||`status=${a.status}`)):O(`Header diagnostic: unexpected response (status=${a.status}).`)}catch(s){O(`Header diagnostic failed: ${s.message}`)}Q(!1),setTimeout(()=>O(null),7e3)},De=t=>{Ne("x-api-key",t)},[ye,ne]=m.useState(null),[$e,oe]=m.useState([]),Me=()=>{if(!i||i.length===0){ne("No input scenarios loaded"),oe([]);return}if(!b||b.length===0){ne("No baseline file loaded"),oe([]);return}const t=i.length;let s=0;const n=[];for(let a=0;a<Math.min(20,i.length);a++){const l=i[a],r=ke(l,b),o=!!r&&String(r).trim()!=="";o&&s++,n.push({inputIdx:a,testCaseId:l.test_case_id,matched:o,reason:o?"Matched":"No matching month/zodiac entry found"})}ne(`Baseline quick-check: ${s} / ${Math.min(20,t)} matched (first 20)`),oe(n)};m.useEffect(()=>{const t=localStorage.getItem(de);if(t)try{const s=JSON.parse(t);s.testCases&&h(s.testCases),s.curlString&&x(s.curlString),s.expectedField&&G(s.expectedField),s.compConfig&&ue(s.compConfig),s.customHeaders&&Y(s.customHeaders)}catch(s){console.error("Restore error",s)}},[]),m.useEffect(()=>{localStorage.setItem(de,JSON.stringify({testCases:p,curlString:c,expectedField:R,compConfig:B,customHeaders:S}))},[p,c,R,B,S]);const ie=(t,s)=>{if(t==null)return"";if(!s||!s.trim())return typeof t=="object"?JSON.stringify(t,null,2):String(t);const n=s.trim().replace(/\[(\d+)\]/g,".$1").replace(/^\./,"").split(".").filter(r=>r!=="");let a=t,l=!0;Array.isArray(a)&&n[0]!=="0"&&isNaN(Number(n[0]))&&(a=a[0]);for(const r of n){if(a==null){l=!1;break}if(typeof a=="object"&&a[r]!==void 0)a=a[r];else if(Array.isArray(a)&&!isNaN(Number(r))&&a[Number(r)]!==void 0)a=a[Number(r)];else{l=!1;break}}return l&&a!==void 0&&a!==null?typeof a=="object"?JSON.stringify(a,null,2):String(a).trim():typeof t=="string"?t:""},we=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],ve=(t,s)=>{const n=[];if(!t||!s)return n;const a=String(t).trim(),l=String(s).trim(),r=l.length>=2?l.slice(-2):l;n.push(`${a}-${l}`);const o=Number(a);!isNaN(o)&&o>=1&&o<=12&&(n.push(`${o}-${l}`),n.push(`${String(o).padStart(2,"0")}-${l}`),n.push(`${we[o-1]}-${r}`),n.push(`${we[o-1]}-${l}`));const u=a.match(/^([A-Za-z]{3})-(\d{2,4})$/);if(u){const d=u[1],j=u[2];n.push(`${d}-${j}`),j.length===2&&n.push(`${d}-${"20"+j}`)}if(l.length===4){const d=l.slice(-2);n.push(`${a}-${d}`)}return Array.from(new Set(n))},ke=(t,s)=>{const n=(o,u)=>{for(const d of u){const j=s.find(N=>(N.month||"").toLowerCase()===d.toLowerCase()&&(N.zodiac_name||"").toLowerCase()===o);if(j)return j.description||""}return""};if(t.expected_csv_key){const o=(t.expected_csv_key||"").split("_");if(o.length>=3){const u=o[0].toLowerCase(),d=o[1],j=o[2],N=[];if(/^\d{2,4}$/.test(d)){const E=Number(d);N.push(d),N.push(String(E-1)),N.push(String(E+1)),d.length===2&&N.push("20"+d),d.length===4&&N.push(d.slice(-2))}else N.push(d);for(const E of Array.from(new Set(N))){const _=ve(j,E),f=n(u,_);if(f)return f}}}const a=t.month||t.month_number||t.MM,l=t.year||t.y,r=(t.zodiac||t.zodiac_name||"").toLowerCase();if(a&&l&&r){const o=Number(l),u=[String(l),String(o-1),String(o+1)];for(const d of Array.from(new Set(u))){const j=ve(a,d),N=n(r,j);if(N)return N}}return""},Se=m.useCallback((t,s)=>{if(t.length===0)return;const n=t.map((a,l)=>{let r="";if(s.length>0&&(r=ke(a,s)),!r){const o=(s.length>0?s[l]:a)||{};o[R]?r=o[R]:o.description?r=o.description:r=Object.values(o)[0]||""}return{id:`tc-${l}-${Date.now()}`,params:a,expectedResult:r,status:w.PENDING}});h(n)},[R]),Ce=async()=>{if(T==="bypass"||S.length===0)return!0;try{const n=(await fetch("https://stagingapi.astroapi.com/api/v1/prediction/monthly?language=eng&month=1&year=2026&report=LOVE&zodiac=ARIES",{method:"OPTIONS"})).headers.get("access-control-allow-headers")||"";for(const a of S)if(a.key&&!new RegExp(a.key,"i").test(n))return O("Preflight: server does not allow required custom header(s)."),z(`Access-Control-Allow-Headers: ${n}`),!1;return!0}catch(t){return O("Preflight failed: cannot verify Access-Control-Allow-Headers"),z(String(t.message)),!1}},Ve=async()=>{const t=Ae(c);if(!t.url||p.length===0){alert("Missing requirements.");return}if(S.length>0&&T==="direct"&&!await Ce()){alert("CORS preflight check failed: server does not allow one or more custom headers (see Test Headers). Aborting run.");return}I(!0),U(0);const s=[...p],n=3,a=2e3;S.length>0&&T==="bypass"&&(V("Custom headers detected: switching to Direct mode"),X("direct"));for(let l=0;l<s.length;l++){const r=s[l];r.status=w.RUNNING,h([...s]);try{const o=M(t.url,r.params);r.finalUrl=o;let u="",d=0,j=0,N=!1;for(;j<n&&!N;){j++;try{if(T==="bypass"){const g={};Object.entries(t.headers).forEach(([$,ce])=>{L.includes($.toLowerCase())||(g[$]=M(ce,r.params))}),S.forEach($=>{$.key&&!L.includes($.key.toLowerCase())&&(g[$.key]=M($.value,r.params))}),r.finalHeaders=g;const F=await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(o)}`);u=(await F.json()).contents,d=F.status}else{const g={};Object.entries(t.headers).forEach(([D,$])=>{L.includes(D.toLowerCase())||(g[D]=M($,r.params))}),S.forEach(D=>{D.key&&!L.includes(D.key.toLowerCase())&&(g[D.key]=M(D.value,r.params))}),r.finalHeaders={...g},console.debug("Request for",r.id,{url:o,headers:r.finalHeaders});const F=await fetch(o,{method:t.method,headers:g});u=await F.text(),d=F.status}d===200&&u&&u.trim()!==""?String(u).toLowerCase().includes("please set custom header")?(J(!0),z(u),V("Server indicates a custom header is required. Use Test Headers to diagnose or add x-api-key preset."),j<n&&await new Promise(g=>setTimeout(g,a))):N=!0:j<n&&await new Promise(g=>setTimeout(g,a))}catch{j<n&&await new Promise(F=>setTimeout(F,a))}}r.statusCode=d,r.actualResponse=u;let E="";try{const g=JSON.parse(u);E=ie(g,B.jsonPath)}catch{E=u}const _=g=>(g||"").toLowerCase().replace(/[\p{P}\p{S}]/gu," ").replace(/\s+/g," ").trim(),f=_(r.expectedResult||""),P=_(String(E||"")),H=f!==""&&P.includes(f);let A=!1;if(!H&&f!==""&&P!==""){const g=f.split(" "),F=new Set(P.split(" ")),D=g.filter(ce=>F.has(ce));A=(g.length>0?D.length/g.length:0)>=.55}r.comparedValue=E,r.status=H||A?w.PASSED:w.FAILED}catch(o){r.status=w.ERROR,r.actualResponse=`Error: ${o.message}`}U(Math.round((l+1)/s.length*100)),h([...s])}I(!1)},_e=()=>{if(!v||!K)return;const t=[...p],s=t.findIndex(l=>l.id===v.id);if(s===-1)return;const n=t[s];n.actualResponse=K,n.statusCode=200;let a="";try{const l=JSON.parse(K);a=ie(l,B.jsonPath)}catch{a=K}n.comparedValue=a,n.status=a.toLowerCase().includes(n.expectedResult.toLowerCase())?w.PASSED:w.FAILED,h(t),q({...n}),xe(""),pe(!0),setTimeout(()=>pe(!1),2e3)},Ee=async t=>{if(!t)return;const s=Ae(c);if(!s.url){alert("Missing cURL template");return}if(S.length>0&&T==="direct"&&!await Ce()){alert("CORS preflight check failed: server does not allow one or more custom headers (see Test Headers). Aborting run.");return}const n=[...p],a=n.findIndex(u=>u.id===t.id);if(a===-1)return;const l=n[a];l.status=w.RUNNING,h([...n]);const r=3,o=2e3;try{const u=M(s.url,l.params);l.finalUrl=u;let d="",j=0,N=0,E=!1;for(S.length>0&&T==="bypass"&&(V("Custom headers detected: switching to Direct mode"),X("direct"));N<r&&!E;){N++;try{if(T==="bypass"){const f={};Object.entries(s.headers).forEach(([A,g])=>{L.includes(A.toLowerCase())||(f[A]=M(g,l.params))}),S.forEach(A=>{A.key&&!L.includes(A.key.toLowerCase())&&(f[A.key]=M(A.value,l.params))}),l.finalHeaders=f;const P=await fetch(`https://api.allorigins.win/get?url=${encodeURIComponent(u)}`);d=(await P.json()).contents,j=P.status}else{const f={};Object.entries(s.headers).forEach(([H,A])=>{L.includes(H.toLowerCase())||(f[H]=M(A,l.params))}),S.forEach(H=>{H.key&&!L.includes(H.key.toLowerCase())&&(f[H.key]=M(H.value,l.params))}),l.finalHeaders={...f};const P=await fetch(u,{method:s.method,headers:f});d=await P.text(),j=P.status}j===200&&d&&d.trim()!==""?String(d).toLowerCase().includes("please set custom header")?(J(!0),z(d),V("Server indicates a custom header is required. Use Test Headers to diagnose or add x-api-key preset."),N<r&&await new Promise(f=>setTimeout(f,o))):E=!0:N<r&&await new Promise(f=>setTimeout(f,o))}catch{N<r&&await new Promise(P=>setTimeout(P,o))}}l.statusCode=j,l.actualResponse=d;let _="";try{const f=JSON.parse(d);_=ie(f,B.jsonPath)}catch{_=d}l.comparedValue=_,l.status=_.toLowerCase().includes(l.expectedResult.toLowerCase())?w.PASSED:w.FAILED}catch(u){l.status=w.ERROR,l.actualResponse=`Error: ${u.message}`}n[a]=l,h([...n]),v&&v.id===l.id&&q({...l})};return e.jsx(Ue,{children:e.jsxs("div",{className:"min-h-screen bg-[#0F172A] text-slate-100 flex flex-col font-sans",children:[e.jsxs("header",{className:"border-b border-slate-800 p-6 flex flex-col md:flex-row justify-between items-center bg-[#1E293B] shadow-2xl gap-6 sticky top-0 z-[60]",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"bg-indigo-600 p-3 rounded-2xl shadow-indigo-500/20 shadow-xl",children:e.jsx("i",{className:"fas fa-stethoscope text-xl"})}),e.jsxs("div",{children:[e.jsxs("h1",{className:"text-xl font-black tracking-tighter uppercase flex items-center gap-2",children:["Horoscope QA Suite",e.jsx("span",{className:"text-[10px] bg-slate-900 border border-indigo-500/30 px-2 py-0.5 rounded text-indigo-400",children:"PRO V3"})]}),e.jsx("p",{className:"text-[10px] text-slate-500 font-bold uppercase tracking-widest",children:"Accuracy & Validation Engine"})]})]}),e.jsxs("div",{className:"flex items-center gap-4 flex-wrap justify-center",children:[e.jsxs("div",{className:"bg-slate-900/50 p-1.5 rounded-2xl flex border border-slate-700",children:[e.jsx("button",{onClick:()=>X("direct"),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase transition-all ${T==="direct"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Direct"}),e.jsx("button",{onClick:()=>X("bypass"),className:`px-5 py-2 rounded-xl text-[10px] font-black uppercase transition-all ${T==="bypass"?"bg-indigo-600 text-white shadow-lg":"text-slate-500 hover:text-slate-300"}`,children:"Proxy"})]}),T==="bypass"&&S.length>0&&e.jsxs("div",{className:"w-full bg-amber-600/10 border-l-4 border-amber-400 text-amber-300 text-[11px] px-4 py-2 rounded-lg mt-2",children:[e.jsx("strong",{className:"font-bold",children:"Warning:"})," Proxy mode may not forward custom headers. Switch to ",e.jsx("span",{className:"font-black",children:"Direct"})," to include them."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{h([]),localStorage.removeItem(de)},className:"bg-slate-800 hover:bg-rose-600/20 hover:text-rose-400 border border-slate-700 p-3 rounded-2xl transition-all",title:"Reset All",children:e.jsx("i",{className:"fas fa-trash-can"})}),e.jsxs("button",{onClick:()=>Te(p,"qa_report.csv"),disabled:p.length===0,className:"bg-emerald-600 hover:bg-emerald-500 px-6 py-3 rounded-2xl font-black shadow-lg disabled:opacity-30 text-[10px] uppercase flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-file-export"})," Report"]}),e.jsxs("button",{onClick:Ve,disabled:C||!c,className:"bg-indigo-600 hover:bg-indigo-500 px-8 py-3 rounded-2xl font-black shadow-lg disabled:opacity-30 transition-all uppercase text-[10px] flex items-center gap-3",children:[C?e.jsx("i",{className:"fas fa-spinner fa-spin"}):e.jsx("i",{className:"fas fa-vial"}),C?"Validating...":"Start Automation"]})]})]})]}),e.jsxs("main",{className:"p-8 space-y-8 max-w-[1800px] mx-auto w-full",children:[e.jsxs("section",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase px-2 tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-code text-indigo-500"})," 1. API Template"]}),e.jsx("textarea",{value:c,onChange:t=>x(t.target.value),className:"w-full h-64 bg-[#1E293B] border border-slate-800 p-6 rounded-[2rem] font-mono text-[11px] text-emerald-400 focus:border-indigo-500 outline-none shadow-inner",placeholder:"Paste Postman cURL..."}),e.jsxs("div",{className:"mt-4 bg-[#111827] border border-slate-800 p-4 rounded-xl",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("label",{className:"text-[9px] font-black text-indigo-400 uppercase mb-2 block",children:"Custom Headers"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>Ne("x-api-key","iVf8NMjXY7Jmb8pjfKG75gumhnjVKvmasH8cEEt2"),className:"text-[10px] bg-emerald-600 px-3 py-1 rounded-xl font-black",children:"Add x-api-key"}),e.jsx("button",{onClick:()=>je(!0),disabled:re,className:"text-[10px] bg-indigo-500 px-3 py-1 rounded-xl font-black",children:"Test w/ x-api-key"}),e.jsx("button",{onClick:()=>je(!1),disabled:re,className:"text-[10px] bg-sky-600 px-3 py-1 rounded-xl font-black",children:re?"Testing...":"Test Headers"})]})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("input",{value:te,onChange:t=>{he(t.target.value),ae(be(t.target.value))},placeholder:"Header-Name (e.g. X-Custom-Header)",className:"w-1/4 bg-slate-900 border border-slate-700 p-2 rounded-xl text-[11px]"}),e.jsx("input",{value:me,onChange:t=>fe(t.target.value),placeholder:"Value or {param}",className:"flex-1 bg-slate-900 border border-slate-700 p-2 rounded-xl text-[11px]"}),e.jsx("button",{onClick:Ie,disabled:!!se||!te.trim(),className:"bg-indigo-600 px-4 py-2 rounded-xl text-[11px] font-black disabled:opacity-30",children:"Add"})]}),se&&e.jsx("div",{className:"text-[10px] text-rose-400 mt-2",children:se}),e.jsxs("div",{className:"mt-3 space-y-2",children:[S.map((t,s)=>e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("div",{className:"text-[11px] font-bold",children:[t.key,":"]}),e.jsx("div",{className:"text-[11px] text-slate-400 truncate",children:t.value}),e.jsx("button",{onClick:()=>Oe(s),className:"ml-auto text-rose-400 text-[10px] font-black",children:"Remove"})]},s)),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("p",{className:"text-[9px] text-slate-500 italic",children:"Note: Forbidden headers (user-agent, origin, host, cookie, etc.) are not allowed."})}),W&&e.jsx("div",{className:"text-[10px] text-emerald-400 mt-2",children:W}),ge&&e.jsxs("div",{className:`mt-2 p-3 rounded ${le?"bg-rose-700/80 text-white":"bg-emerald-700/10 text-emerald-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between gap-4",children:[e.jsx("div",{className:"text-[11px] font-bold",children:ge}),le&&e.jsx("div",{className:"flex items-center gap-2",children:e.jsx("button",{onClick:()=>De("iVf8NMjXY7Jmb8pjfKG75gumhnjVKvmasH8cEEt2"),className:"bg-emerald-600 px-3 py-1 rounded-xl text-[10px] font-black",children:"Add x-api-key"})})]}),Z&&e.jsx("pre",{className:"mt-2 text-xs whitespace-pre-wrap bg-black/10 p-2 rounded",children:String(Z)}),le&&Z&&String(Z).toLowerCase().includes("access-control-allow-headers")&&e.jsxs("div",{className:"mt-3 text-[11px] bg-black/10 p-3 rounded",children:[e.jsx("div",{className:"font-bold mb-1",children:"Suggested fix"}),e.jsxs("div",{className:"text-[10px] text-slate-300 space-y-1",children:[e.jsxs("div",{children:["Add ",e.jsx("code",{children:'"x-api-key"'})," to the server's ",e.jsx("code",{children:"Access-Control-Allow-Headers"})," for the API origin so browsers can send the header."]}),e.jsxs("div",{className:"mt-2",children:["Example (Express + cors): ",e.jsx("code",{children:"app.use(cors({ origin: true, allowedHeaders: ['Content-Type','x-api-key','Authorization'] }))"})]}),e.jsxs("div",{className:"mt-1",children:["Nginx example: ",e.jsx("code",{children:"add_header 'Access-Control-Allow-Headers' 'Origin, X-Requested-With, Content-Type, Accept, Language, x-api-key';"})]})]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase px-2 tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-table-list text-indigo-500"})," 2. Scenarios CSV"]}),e.jsxs("div",{className:"h-64 border-4 border-dashed border-slate-800 rounded-[2rem] flex flex-col items-center justify-center p-8 bg-[#1E293B]/30 hover:bg-[#1E293B] transition-all relative group",children:[e.jsx("input",{type:"file",accept:".csv",onChange:t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];if(!s)return;const n=new FileReader;n.onload=l=>{var o;const r=Re((o=l.target)==null?void 0:o.result);y(r),Se(r,b)},n.readAsText(s)},className:"absolute inset-0 opacity-0 cursor-pointer"}),e.jsx("i",{className:"fas fa-file-csv text-3xl text-slate-700 mb-4 group-hover:text-indigo-500 transition-colors"}),e.jsx("p",{className:"text-[10px] font-black uppercase text-slate-500",children:i.length>0?`${i.length} ROWS LOADED`:"UPLOAD INPUTS"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase px-2 tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-file-circle-check text-indigo-500"})," 3. Baseline CSV"]}),e.jsxs("div",{className:"h-64 border-4 border-dashed border-slate-800 rounded-[2rem] flex flex-col items-center justify-center p-8 bg-[#1E293B]/30 hover:bg-[#1E293B] transition-all relative group",children:[e.jsx("input",{type:"file",accept:".csv",onChange:t=>{var a;const s=(a=t.target.files)==null?void 0:a[0];if(!s)return;const n=new FileReader;n.onload=l=>{var o;const r=Re((o=l.target)==null?void 0:o.result);k(r),Se(i,r)},n.readAsText(s)},className:"absolute inset-0 opacity-0 cursor-pointer"}),e.jsx("i",{className:"fas fa-bullseye text-3xl text-slate-700 mb-4 group-hover:text-emerald-500 transition-colors"}),e.jsx("p",{className:"text-[10px] font-black uppercase text-slate-500",children:b.length>0?`${b.length} BASELINES LOADED`:"UPLOAD EXPECTED"}),e.jsxs("div",{className:"mt-4 text-[10px] text-slate-400",children:[e.jsx("div",{className:"font-bold mb-1",children:"Expected baseline CSV format"}),e.jsxs("div",{className:"mb-2",children:["The baseline must include columns: ",e.jsx("code",{children:"month"})," (e.g., ",e.jsx("code",{children:"Jan-26"}),"), ",e.jsx("code",{children:"zodiac_name"})," (e.g., ",e.jsx("code",{children:"aries"}),"), ",e.jsx("code",{children:"title"}),", and ",e.jsx("code",{children:"description"}),". Matching is case-insensitive and supports several month formats."]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>{Te([{month:"Jan-26",zodiac_name:"aries",title:"Aries Monthly Horoscope",description:"This month begins with..."}],"baseline_sample.csv")},className:"bg-emerald-600 px-3 py-1 rounded-xl text-[10px] font-black",children:"Download sample baseline"}),e.jsx("button",{onClick:()=>{var t,s;return(s=(t=navigator.clipboard)==null?void 0:t.writeText(`month,zodiac_name,title,description
Jan-26,aries,Aries Monthly Horoscope,This month begins with...`))==null?void 0:s.then(()=>V("Sample copied to clipboard"))},className:"bg-sky-600 px-3 py-1 rounded-xl text-[10px] font-black",children:"Copy CSV header"}),e.jsx("button",{onClick:()=>Me(),className:"bg-indigo-600 px-3 py-1 rounded-xl text-[10px] font-black",children:"Validate mapping (first 20)"})]}),W&&e.jsx("div",{className:"text-[10px] text-emerald-400 mt-2",children:W}),ye&&e.jsxs("div",{className:"mt-3 text-[11px] bg-black/10 p-3 rounded",children:[e.jsx("div",{className:"font-bold mb-1",children:ye}),e.jsx("div",{className:"text-[10px] text-slate-300",children:$e.map(t=>e.jsxs("div",{className:`flex items-center gap-2 ${t.matched?"text-emerald-400":"text-rose-400"}`,children:[e.jsxs("div",{className:"font-bold",children:["#",t.inputIdx+1]}),e.jsx("div",{className:"text-[10px]",children:t.testCaseId||""}),e.jsx("div",{className:"ml-auto text-[10px]",children:t.matched?"Matched":t.reason})]},t.inputIdx))})]})]})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h3",{className:"text-[10px] font-black text-slate-500 uppercase px-2 tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sliders-h text-indigo-500"})," 4. Field Mapping"]}),e.jsxs("div",{className:"h-64 bg-[#1E293B] border border-slate-800 p-8 rounded-[2rem] space-y-4 flex flex-col justify-center shadow-xl",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-indigo-400 uppercase mb-1 block",children:"JSON Prediction Path"}),e.jsx("input",{value:B.jsonPath,onChange:t=>ue({...B,jsonPath:t.target.value}),className:"w-full bg-slate-900 border border-slate-700 p-2.5 rounded-xl text-[11px] font-bold text-emerald-400",placeholder:"prediction"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-[9px] font-black text-emerald-400 uppercase mb-1 block",children:"CSV Description Column"}),e.jsx("input",{value:R,onChange:t=>G(t.target.value),className:"w-full bg-slate-900 border border-slate-700 p-2.5 rounded-xl text-[11px] font-bold",placeholder:"description"})]}),e.jsx("p",{className:"text-[8px] text-slate-500 font-bold uppercase leading-tight italic",children:"Matched data will be used for Pass/Fail status"})]})]})]}),p.length>0&&e.jsxs("div",{className:"bg-[#1E293B] rounded-[2.5rem] shadow-2xl border border-slate-800 overflow-hidden",children:[e.jsxs("div",{className:"p-6 border-b border-slate-800 flex justify-between items-center bg-slate-900/30",children:[e.jsxs("h2",{className:"font-black uppercase tracking-tight text-sm flex items-center gap-3",children:[e.jsx("i",{className:"fas fa-list-check text-indigo-500"}),"Validation Queue"]}),e.jsxs("div",{className:"text-[10px] font-black flex gap-6 text-slate-500",children:[e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-emerald-500"})," PASSED: ",p.filter(t=>t.status===w.PASSED).length]}),e.jsxs("span",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 rounded-full bg-rose-500"})," FAILED: ",p.filter(t=>t.status===w.FAILED).length]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full text-left",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-slate-900/50",children:[e.jsx("th",{className:"p-5 px-8 text-[9px] font-black uppercase text-slate-500",children:"#"}),e.jsx("th",{className:"p-5 px-8 text-[9px] font-black uppercase text-slate-500",children:"Scenario Data"}),e.jsx("th",{className:"p-5 px-8 text-[9px] font-black uppercase text-slate-500",children:"Expectation (CSV)"}),e.jsx("th",{className:"p-5 px-8 text-[9px] font-black uppercase text-slate-500 text-center",children:"Status"}),e.jsx("th",{className:"p-5 px-8 text-[9px] font-black uppercase text-slate-500 text-center",children:"Action"})]})}),e.jsx("tbody",{className:"divide-y divide-slate-800",children:p.map((t,s)=>e.jsxs("tr",{className:"hover:bg-slate-800/20 transition-all",children:[e.jsx("td",{className:"p-5 px-8 font-bold text-slate-600 text-[11px]",children:s+1}),e.jsx("td",{className:"p-5 px-8",children:e.jsx("div",{className:"flex gap-2 flex-wrap",children:Object.entries(t.params).slice(0,2).map(([n,a])=>e.jsxs("span",{className:"bg-slate-900/50 px-2.5 py-1 rounded-lg text-[9px] border border-slate-700 font-bold uppercase",children:[e.jsxs("span",{className:"text-slate-500",children:[n,":"]})," ",String(a)]},n))})}),e.jsx("td",{className:"p-5 px-8 max-w-xs overflow-hidden",children:e.jsx("p",{className:"text-[10px] text-slate-400 font-bold line-clamp-2 italic leading-relaxed",children:t.expectedResult||"---"})}),e.jsx("td",{className:"p-5 px-8 text-center",children:e.jsx("span",{className:`px-4 py-1 rounded-full text-[9px] font-black uppercase border ${t.status===w.PASSED?"bg-emerald-500/10 text-emerald-500 border-emerald-500/20 shadow-[0_0_15px_rgba(16,185,129,0.1)]":t.status===w.FAILED?"bg-rose-500/10 text-rose-500 border-rose-500/20 shadow-[0_0_15px_rgba(244,63,94,0.1)]":t.status===w.RUNNING?"bg-indigo-500/10 text-indigo-500 border-indigo-500/20":"bg-slate-800 text-slate-500 border-slate-700"}`,children:t.status})}),e.jsx("td",{className:"p-5 px-8 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("button",{onClick:()=>Ee(t),className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-xl text-[10px] font-black uppercase transition-all shadow-lg active:scale-95",children:"Run"}),e.jsx("button",{onClick:()=>q(t),className:"bg-slate-800 hover:bg-indigo-600 px-6 py-2 rounded-xl text-[10px] font-black uppercase transition-all shadow-lg active:scale-95",children:"Verify"})]})})]},t.id))})]})})]})]}),v&&e.jsx("div",{className:"fixed inset-0 z-[100] bg-black/80 backdrop-blur-md flex items-center justify-center p-6 md:p-12",children:e.jsxs("div",{className:"bg-[#1E293B] w-full max-w-6xl h-[90vh] rounded-[3rem] shadow-2xl flex flex-col border border-slate-700 overflow-hidden",children:[e.jsxs("div",{className:"p-6 bg-slate-900 border-b border-slate-800 flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("h3",{className:"text-lg font-black uppercase tracking-tight",children:"Validation Trace"}),e.jsxs("span",{className:"text-[10px] font-bold bg-indigo-500/10 text-indigo-400 px-3 py-1 rounded-full border border-indigo-500/20",children:["CASE #",p.findIndex(t=>t.id===v.id)+1]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>Ee(v),className:"bg-indigo-600 hover:bg-indigo-500 px-4 py-2 rounded-xl text-[11px] font-black uppercase transition-all shadow-lg",children:"Run Case"}),e.jsx("button",{onClick:()=>q(null),className:"w-10 h-10 bg-slate-800 rounded-full flex items-center justify-center hover:bg-rose-500 transition-all shadow-lg",children:e.jsx("i",{className:"fas fa-times"})})]})]}),e.jsxs("div",{className:"p-10 overflow-y-auto space-y-10 flex-1",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-file-invoice"})," Baseline (From CSV: ",R,")"]}),e.jsx("div",{className:"bg-slate-900 p-6 rounded-[2rem] border border-slate-800 h-48 text-[11px] font-bold text-slate-300 whitespace-pre-wrap leading-relaxed shadow-inner overflow-auto custom-scrollbar",children:v.expectedResult||"No description found in CSV."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("h4",{className:"text-[10px] font-black text-emerald-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-magnifying-glass"})," Extracted (From API: ",B.jsonPath,")"]}),e.jsx("div",{className:`bg-slate-900 p-6 rounded-[2rem] border h-48 text-[11px] font-bold whitespace-pre-wrap leading-relaxed shadow-inner overflow-auto custom-scrollbar ${v.status===w.PASSED?"border-emerald-500/40 text-emerald-400":"border-rose-500/40 text-rose-400"}`,children:v.comparedValue||e.jsx("span",{className:"italic opacity-50",children:"Empty response. Use Postman Sync below."})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("h4",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest",children:"Full Server Response"}),e.jsxs("span",{className:"text-[9px] font-bold bg-slate-900 px-3 py-1 rounded text-slate-500 border border-slate-800 uppercase tracking-widest",children:["Status: ",v.statusCode||"N/A"]})]}),e.jsx("div",{className:"bg-[#0F172A] p-6 rounded-[2rem] font-mono text-[10px] h-48 overflow-auto border border-slate-800 text-emerald-500/80 whitespace-pre-wrap shadow-inner custom-scrollbar",children:v.actualResponse||"No data captured yet."}),e.jsxs("div",{className:"mt-3",children:[e.jsx("h5",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mb-2",children:"Request URL"}),e.jsx("div",{className:"bg-slate-900 p-4 rounded-lg border border-slate-800 text-[11px] font-mono break-words",children:v.finalUrl||"N/A"}),e.jsx("h5",{className:"text-[10px] font-black text-slate-500 uppercase tracking-widest mt-4 mb-2",children:"Request Headers"}),e.jsx("div",{className:"bg-slate-900 p-4 rounded-lg border border-slate-800 text-[11px] whitespace-pre-wrap font-mono",children:v.finalHeaders?Object.entries(v.finalHeaders).map(([t,s])=>e.jsxs("div",{children:[e.jsxs("span",{className:"text-slate-500",children:[t,":"]})," ",s]},t)):e.jsx("div",{className:"italic text-slate-500",children:"No headers recorded for this case."})})]})]}),e.jsxs("div",{className:"bg-indigo-500/5 p-8 rounded-[3rem] border border-indigo-500/10 space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h5",{className:"text-[10px] font-black text-indigo-400 uppercase tracking-widest flex items-center gap-2",children:[e.jsx("i",{className:"fas fa-sync-alt"})," Manual Postman Sync"]}),He&&e.jsxs("span",{className:"text-[10px] font-black text-emerald-500 uppercase animate-bounce",children:[e.jsx("i",{className:"fas fa-check mr-1"})," Saved & Validated!"]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("textarea",{value:K,onChange:t=>xe(t.target.value),placeholder:"Paste the JSON response from Postman for this specific scenario...",className:"flex-1 bg-slate-900 border border-slate-800 p-5 rounded-[1.5rem] text-[10px] font-mono h-24 focus:border-indigo-500 outline-none shadow-lg transition-all"}),e.jsxs("button",{onClick:_e,className:"bg-indigo-600 hover:bg-indigo-500 px-10 py-5 rounded-[1.5rem] font-black text-[10px] uppercase shadow-[0_10px_30px_rgba(79,70,229,0.3)] transition-all flex items-center justify-center gap-3 active:scale-95",children:[e.jsx("i",{className:"fas fa-save"})," Sync Result"]})]})]})]})]})}),e.jsx("style",{children:`
        .custom-scrollbar::-webkit-scrollbar { width: 6px; height: 6px; }
        .custom-scrollbar::-webkit-scrollbar-track { background: #0F172A; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb { background: #334155; border-radius: 10px; }
        .custom-scrollbar::-webkit-scrollbar-thumb:hover { background: #475569; }
        .line-clamp-2 { display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden; }
      `})]})})};export{ze as default};
